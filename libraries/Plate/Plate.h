
#include "Arduino.h"
#include "Maxim.h"
#include "Reporter.h"
#include "SdFat.h"
#include <EEPROM.h>

#ifndef Plate_h
#define Plate_h

const byte WELL_KEYS[97] = {
   // A
   B1010100,B1001100,B1100100,B1110100,B1111100,B1101100,
   B0010100,B0001100,B0100100,B0110100,B0111100,B0101100,

   // B
   B1010110,B1001110,B1100110,B1110110,B1111110,B1101110,
   B0010110,B0001110,B0100110,B0110110,B0111110,B0101110,

   // C
   B1010010,B1001010,B1100010,B1110010,B1111010,B1101010,
   B0010010,B0001010,B0100010,B0110010,B0111010,B0101010,

   // D
   B1010001,B1001001,B1100001,B1110001,B1111001,B1101001,
   B0010001,B0001001,B0100001,B0110001,B0111001,B0101001,

   // E
   B1010011,B1001011,B1100011,B1110011,B1111011,B1101011,
   B0010011,B0001011,B0100011,B0110011,B0111011,B0101011,

   // F
   B1010101,B1001101,B1100101,B1110101,B1111101,B1101101,
   B0010101,B0001101,B0100101,B0110101,B0111101,B0101101,

   // G
   B1010000,B1001000,B1100000,B1110000,B1111000,B1101000,
   B0010000,B0001000,B0100000,B0110000,B0111000,B0101000,

   // H
   B1010111,B1001111,B1100111,B1110111,B1111111,B1101111,
   B0010111,B0001111,B0100111,B0110111,B0111111,B0101111,

   B1111111
};

const byte RESISTOR_KEYS[97] = {
   B11100000,B11111100,B11111100,B11111100,B11100000,B11111100,
   B11111100,B11111100,B11100000,B11111100,B11111100,B11111100,

   B11100000,B11111100,B11111100,B11111100,B11100000,B11111100,
   B11111100,B11111100,B11100000,B11111100,B11111100,B11111100,

   B11100000,B11111111,B11111100,B11111100,B11100000,B11111111,
   B11111100,B11111100,B11100000,B11111111,B11111100,B11111100,

   B11100000,B11111111,B11111100,B11111100,B11100000,B11111111,
   B11111100,B11111100,B11100000,B11111111,B11111100,B11111100,

   B11000000,B11111100,B11111100,B11111100,B11000000,B11111100,
   B11111100,B11111100,B11000000,B11111100,B11111100,B11111100,

   B11100000,B11111100,B11111100,B11111100,B11100000,B11111100,
   B11111100,B11111100,B11100000,B11111100,B11111100,B11111100,

   B11110000,B11111100,B11111100,B11111100,B11110000,B11111100,
   B11111100,B11111100,B11110000,B11111100,B11111100,B11111100,

   B11111100,B11111100,B11111100,B11111100,B11111100,B11111100,
   B11111100,B11111100,B11111100,B11111100,B11111100,B11111100   
};

const byte RESISTOR_CHANNELS[] = {2, 1, 0, 3};

// const byte RESISTOR_CHANNELS[] = {EEPROM.read(1), EEPROM.read(2), EEPROM.read(3), EEPROM.read(4)};

class Plate {
   public:
      int n_reads;  // 0 - 256
      int read_delay;  // millis
      float voltage;  // normalized (0.0 - 1.0)

      Plate();
      void set_well(int well);
      void set_resistor(int channel);
      float read_voltage();
      void read_voltages();
      void set_channels(int UA, int HC, int HB, int HA,
                        int VC, int VB, int VA);
      void set_resistor_mux_channels(int A, int B, int C);

   private:
      int _channels[7];
      
      Maxim _resistor_mux;
};


#endif


